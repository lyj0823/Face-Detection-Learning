
#Robust Face Detection via Learning Small Faces on Hard Images
使用困难图像训练的单一检测层的人脸检测器。
基于anchor的人脸检测算法已经取得不错结果，但是对于困难人脸而言依旧充满挑战。
一个原因是同等对待这些人脸，并没有更加关注困难人脸。然而许多训练图像只包含容易的人脸，对于困难图像的人脸检测没有帮助。
本文提出稳健的人脸检测器提高困难人脸检测，通过在困难图像上学习小脸。困难图像是至少包含一个困难人脸的图像，大部分困难人脸是小脸，
其他类型的困难人脸可以通过缩放转换为小脸。我们构建一个基于anchor的深度人脸检测器，只输出一个尺度的特征图，它具有小的anchors来特地学习小脸，
我们通过困难图像挖掘策略来学习。进一步的实验表明我们的检测器在WIDER FACE的三个测试集上达到95.7,94.9和89.7AP.
该方法和大多数SOAT方法相比具有优越性，特别在hard子集上。

算法使用VGG网络作为基础特征提取器，融合conv4_3和conv5_3然后生成单一的检测层。
和之前大多数检测算法不同，这里只使用单一的检测层做分类和回归，这使得其简单而高效。之前大多数做法是使用不同网络层检测不同尺度的目标。在这个单一检测层上后面介绍到设置三个大小的anchor,为了解决同一特征层检测不同大小目标，这里对融合后的特征层进一步处理:先使用3*3卷积将维度从512降到128，然后使用不同大小的空洞卷积生成最终检测层。
如S3FD在六个特征层上设置不同anchor，SSH则对于相邻大小的anchor共享特征使用三个特征层进行检测。我们这里限制anchor大小16*16,32*32和64*64，训练时，太小和太大的人脸被忽略，这样网络学习时会关注于这些小脸。为了解决大人脸，这里使用多尺度训练和测试，经过resize使其与我们设置的anchor匹配。

难例图像挖掘
D代表所有训练图像如WIDIER FACE，D’代表困难图像集合用于训练
开始时，所有训练图像都被当做hard images，D=D’.在ImageNet预训练的模型用于人脸检测时对这些图像没有区分性。
训练开始后，我们对训练图像计算不同困难得分:对于给定一幅图像，图像中每一个正anchor被预测为人脸的概率的最小值如果高于阈值，那么该图像被认为是easy图像。也就是这里的正样本基本上以很大概率被预测为人脸。这样在接下来训练时以概率p丢弃。对于每一幅图像如此操作得到新的训练集合，这时训练集更加关注困难图像。多GPU训练时，每一个GPU独立生成训练图像。
由于训练时设置的anchor只有三种尺度，为了检测不同大小人脸，使用图像金字塔检测以适应设置的anchors.

